<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title id="site-title"></title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" id="site-desc" />
  <link rel="stylesheet" href="style.css" />
  <script src="data.js"></script>

  <link rel="icon" type="image/svg+xml" sizes="any" href="/img/icons/favicon.svg?v=1">
  <link rel="icon" type="image/png" href="/img/icons/favicon-48.png">
  <meta name="theme-color" content="#FFC2D4">

  <!-- Independent tuning for poster & video -->
  <style>
    .preview-card .thumb{
      aspect-ratio: var(--frame-ratio, 16/9);
      position: relative;
      overflow: hidden;
      border-radius: 12px;
      background: #000;
      margin-bottom: 10px;
    }
    .thumb .poster,
    .thumb .clip{
      position: absolute; inset: 0;
      width: 100%; height: 100%;
      object-fit: cover;
      display: block;
    }
    /* Poster tuning */
    .thumb .poster{
      object-position: var(--poster-x, 50%) var(--poster-y, 50%);
      transform-origin: var(--poster-x, 50%) var(--poster-y, 50%);
      transform: scale(var(--poster-zoom, 1));
    }
    /* Video tuning */
    .thumb .clip{
      object-position: var(--video-x, 50%) var(--video-y, 50%);
      transform-origin: var(--video-x, 50%) var(--video-y, 50%);
      transform: scale(var(--video-zoom, 1));
      opacity: 0; transition: opacity .18s ease;
      pointer-events: none;
    }
    .preview-card:hover .thumb .clip,
    .preview-card:focus-within .thumb .clip{ opacity: 1; }
  </style>
</head>
<body>
  <div id="top"></div>

  <header>
    <div class="brand">
      <div>
        <strong id="name"></strong><br />
        <span id="tagline"></span>
      </div>
    </div>
    <nav>
      <a href="/#top" class="home-link">Home</a>
      <a href="portfolio.html">Portfolio</a>
      <a href="extracurriculars.html">Extracurriculars</a>
      <a href="/#contact">Contact</a>
      <button id="theme-toggle" class="icon-btn" type="button" aria-label="Toggle theme"></button>
    </nav>
  </header>

  <main>
    <section id="hero" class="hero">
      <div class="hero-aside">
        <div class="hero-image">
          <img id="hero-avatar" class="avatar-tune" src="/img/avatar.jpg" alt="Headshot of Kaitlin Calimbahin" />
        </div>
        <div id="hero-contacts" class="hero-contacts plain"></div>
      </div>

      <div class="hero-text">
        <span class="pill">Open to internships • Summer 2026</span>
        <h1 id="hero-title"></h1>
        <p id="about-text" class="about-in-hero"></p>
        <div class="row">
          <a class="btn" href="/resume.html" target="_blank" rel="noopener">View Resume</a>
          <a href="portfolio.html">View Projects ↗</a>
        </div>
      </div>
    </section>

    <section id="projects">
      <h2>Projects</h2>
      <div id="projects-highlights" class="preview-grid"></div>
      <p style="margin-top:10px"><a class="btn" href="portfolio.html">View all projects</a></p>
    </section>

    <section id="experience">
      <h2>Experience</h2>
      <div id="experience-highlights" class="preview-grid"></div>
      <p style="margin-top:10px"><a class="btn" href="portfolio.html#experience">View all experience</a></p>
    </section>

    <section id="extracurriculars">
      <h2>Extracurriculars</h2>
      <div id="extracurriculars-highlights" class="preview-grid"></div>
      <p style="margin-top:10px"><a class="btn" href="extracurriculars.html">View all extracurriculars</a></p>
    </section>

    <section id="contact">
      <h2>Contact</h2>
      <p id="contact-links"></p>
    </section>
  </main>

  <footer>
    © <span id="year"></span> <span id="name-footer"></span>
  </footer>

  <script>
    /* helpers */
    const setText = (id, t) => { const el = document.getElementById(id); if (el) el.textContent = t; };
    const setSrc  = (id, s) => { const el = document.getElementById(id); if (el) el.src = s; };

    /* icons */
    const mailSvg = `
      <svg class="icon" viewBox="0 0 16 16" aria-hidden="true">
        <path fill="currentColor" d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v.217L8 8.5 0 4.217V4z"/>
        <path fill="currentColor" d="M0 4.697v7.104A2 2 0 0 0 2 14h12a2 2 0 0 0 2-2.199V4.697L8 9.5 0 4.697z"/>
      </svg>`;
    const liSvg = `
      <svg class="icon" viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <path fill="currentColor"
          d="M100.28 448H7.4V148.9h92.88V448zM53.84 106.1C24.1 106.1 0 82 0 52.3
             0 22.6 24.1-1.5 53.84-1.5S107.7 22.6 107.7 52.3c0 29.7-24.1 53.8-53.86 53.8zM447.9 448h-92.4V302.4
             c0-34.7-.7-79.3-48.3-79.3-48.3 0-55.7 37.7-55.7 76.7V448h-92.5V148.9h88.8v40.8h1.3c12.4-23.5 42.7-48.3
             87.9-48.3 94 0 111.3 61.9 111.3 142.3V448z"/>
      </svg>`;

    /* meta + header/footer text */
    document.title = siteData.title;
    const desc = document.getElementById("site-desc");
    if (desc) desc.setAttribute("content", siteData.description);
    setSrc("hero-avatar", siteData.avatar);
    setText("name", siteData.name);
    setText("tagline", siteData.tagline);
    setText("name-footer", siteData.name);
    setText("year", new Date().getFullYear());
    setText("hero-title", siteData.heroTitle);
    setText("about-text", siteData.about);

    /* contacts */
    const hc = document.getElementById("hero-contacts");
    if (hc) {
      hc.innerHTML = `
        <a class="contact-link" href="${siteData.emailHref}">${mailSvg}<span>Email</span></a>
        <a class="contact-link" href="${siteData.linkedinHref}" target="_blank" rel="noopener">${liSvg}<span>LinkedIn</span></a>`;
    }
    const cl = document.getElementById("contact-links");
    if (cl) {
      cl.innerHTML = `
        <a class="contact-link" href="${siteData.emailHref}">${mailSvg}<span>Email</span></a>
        <span class="sep-bar"> | </span>
        <a class="contact-link" href="${siteData.linkedinHref}" target="_blank" rel="noopener">${liSvg}<span>LinkedIn</span></a>`;
    }

    /* ================= Media sources (projects) ================= */
    const MEDIA = {
      "haptic-glove": { poster: "/media/projects/haptic-glove.png", video: "/media/projects/haptic-glove.mp4" },
      "kitty-robot":  { poster: "/media/projects/kitty-robot.png",  video: "/media/projects/kitty-robot.mp4" },
      "ironman":      { poster: "/media/projects/ironman.png",      video: "/media/projects/ironman.mp4" }
    };

    /* ========= Per-card tuning (projects) ========= */
    const MEDIA_TUNING = {
      "haptic-glove": { ratio:"16 / 12",
        poster:{ x:"50%", y:"50%", zoom:1.00 },
        video: { x:"52%", y:"48%", zoom:1.06 }
      },
      "kitty-robot":  { ratio:"16 / 17",
        poster:{ x:"1%",  y:"40%", zoom:1.35 },
        video: { x:"1%",  y:"40%", zoom:1.35 }
      },
      "ironman":      { ratio:"15 / 16",
        poster:{ x:"50%", y:"30%", zoom:1.00 },
        video: { x:"50%", y:"60%", zoom:1.15 }
      }
    };

    /* ================= Media sources (experience photos) ================= */
    const EXP_MEDIA = {
      "robotics-lead": { poster: "/media/experience/arclab.png" },
      "ng-intern":     { poster: "/media/experience/ng.png" }
    };

    /* ========= Per-card tuning (experience photos) ========= */
    const EXP_TUNING = {
      "robotics-lead": { ratio:"16 / 9", poster:{ x:"50%", y:"100%", zoom:1.00 } },
      "ng-intern":     { ratio:"16 / 9", poster:{ x:"50%", y:"50%",  zoom:1.15 } }
    };

    /* ================= Media sources (extracurricular photos) ================= */
    const EXTRA_MEDIA = {
      "ieee": { poster: "/media/extracurriculars/ieee.png" },
      "tea":  { poster: "/media/extracurriculars/tea.png"  }
    };

    /* ========= Per-card tuning (extracurricular photos) ========= */
    const EXTRA_TUNING = {
      "ieee": { ratio:"16 / 9", poster:{ x:"5%", y:"50%", zoom:1.05 } },
      "tea":  { ratio:"16 / 9", poster:{ x:"55%", y:"100%", zoom:1.50 } }
    };

    function applyTuning(thumb, tuning){
      if (!thumb || !tuning) return;
      if (tuning.ratio) thumb.style.aspectRatio = tuning.ratio;

      const p = tuning.poster || {};
      const v = tuning.video  || {};

      // Poster variables
      if (p.x)    thumb.style.setProperty('--poster-x', p.x);
      if (p.y)    thumb.style.setProperty('--poster-y', p.y);
      if (p.zoom) thumb.style.setProperty('--poster-zoom', p.zoom);

      // Video variables (only used by projects that have video)
      if (v.x)    thumb.style.setProperty('--video-x', v.x);
      if (v.y)    thumb.style.setProperty('--video-y', v.y);
      if (v.zoom) thumb.style.setProperty('--video-zoom', v.zoom);
    }

    /* =============== Card builder (poster + hover video for projects) =============== */
    function makePreviewCard(item, descKey="desc"){
      const a = document.createElement("a");
      a.className = "preview-card";
      a.href = `portfolio.html#${item.id}`;

      const cfg = MEDIA[item.id];
      let mediaHTML;
      if (cfg) {
        mediaHTML = `
          <div class="thumb">
            <img class="poster" src="${cfg.poster}" alt="${item.title}">
            <video class="clip" muted playsinline loop preload="metadata">
              <source src="${cfg.video}" type="video/mp4">
            </video>
          </div>`;
      } else {
        mediaHTML = `<div class="thumb"><img class="poster" src="${item.img}" alt="${item.title}"></div>`;
      }

      a.innerHTML = `
        ${mediaHTML}
        <h3>${item.title}</h3>
        <p class="muted">${item[descKey] || ""}</p>
      `;

      // Apply project tuning
      applyTuning(a.querySelector('.thumb'), MEDIA_TUNING[item.id]);

      // Hover/focus: play/pause (resumes where paused)
      const vid = a.querySelector('video.clip');
      if (vid) {
        const play  = () => vid.play().catch(()=>{});
        const pause = () => vid.pause();
        a.addEventListener('mouseenter', play);
        a.addEventListener('mouseleave', pause);
        a.addEventListener('focusin',    play);
        a.addEventListener('focusout',   pause);
        document.addEventListener('visibilitychange', () => { if (document.hidden) vid.pause(); });
      }

      return a;
    }

    /* =============== Card builder (experience photos only) =============== */
    function makeExperienceCard(item){
      const a = document.createElement("a");
      a.className = "preview-card";
      a.href = `portfolio.html#${item.id}`;

      const cfg = EXP_MEDIA[item.id];
      const mediaHTML = `
        <div class="thumb">
          <img class="poster" src="${cfg ? cfg.poster : item.img}" alt="${item.title}">
        </div>`;

      a.innerHTML = `
        ${mediaHTML}
        <h3>${item.title}</h3>
        <p class="muted">${item.details || ""}</p>
      `;

      // Apply experience tuning
      applyTuning(a.querySelector('.thumb'), EXP_TUNING[item.id]);

      return a;
    }

    /* =============== Card builder (extracurricular photos only) =============== */
    function makeExtracurricularCard(item){
      const a = document.createElement("a");
      a.className = "preview-card";
      a.href = `extracurriculars.html#${item.id}`;

      const cfg = EXTRA_MEDIA[item.id];
      const mediaHTML = `
        <div class="thumb">
          <img class="poster" src="${cfg ? cfg.poster : item.img}" alt="${item.title}">
        </div>`;

      a.innerHTML = `
        ${mediaHTML}
        <h3>${item.title}</h3>
        <p class="muted">${item.details || ""}</p>
      `;

      // Apply extracurricular tuning
      applyTuning(a.querySelector('.thumb'), EXTRA_TUNING[item.id]);

      return a;
    }

    /* projects */
    const ph = document.getElementById("projects-highlights");
    if (ph && siteData.highlights?.projects) {
      siteData.highlights.projects.forEach(id => {
        const p = siteData.projects.find(x => x.id === id);
        if (p) ph.appendChild(makePreviewCard(p,"desc"));
      });
    }

    /* experience */
    const eh = document.getElementById("experience-highlights");
    if (eh && siteData.highlights?.experience) {
      siteData.highlights.experience.forEach(id => {
        const e = siteData.experience.find(x => x.id === id);
        if (!e) return;
        eh.appendChild(makeExperienceCard(e));
      });
    }

    /* extracurriculars (now uses /media/extracurriculars/*.png + tuning) */
    const xh = document.getElementById("extracurriculars-highlights");
    if (xh && siteData.highlights?.extracurriculars) {
      siteData.highlights.extracurriculars.forEach(id => {
        const x = siteData.extracurriculars.find(e => e.id === id);
        if (!x) return;
        xh.appendChild(makeExtracurricularCard(x));
      });
    }

    /* Theme toggle */
    const ICON_SUN = `
      <svg viewBox="0 0 24 24" fill="none"
        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
        <circle cx="12" cy="12" r="4"></circle>
        <path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M4.93 19.07l1.41-1.41M17.66 6.34l1.41-1.41"/>
      </svg>`;
    const ICON_MOON = `
      <svg viewBox="0 0 24 24" fill="none"
        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
      </svg>`;

    (function initTheme(){
      const root = document.documentElement;
      const btn = document.getElementById('theme-toggle');
      if (!btn) return;

      const prefersDark = () => window.matchMedia('(prefers-color-scheme: dark)').matches;
      const getTheme = () => localStorage.getItem('theme') || (prefersDark() ? 'dark' : 'light');
      const apply = (t) => {
        root.setAttribute('data-theme', t);
        localStorage.setItem('theme', t);
        btn.innerHTML = t === 'dark' ? ICON_MOON : ICON_SUN;
        btn.title = t === 'dark' ? 'Switch to light mode' : 'Switch to dark mode';
      };

      apply(getTheme());
      btn.addEventListener('click', () => apply(getTheme() === 'dark' ? 'light' : 'dark'));
    })();

    /* Smooth-scroll to top if already on homepage */
    document.querySelectorAll('a.home-link').forEach(a=>{
      a.addEventListener('click', (e)=>{
        const onHome = location.pathname === '/' || location.pathname.endsWith('/index.html') || location.pathname.endsWith('index.html');
        if (onHome){ e.preventDefault(); window.scrollTo({top:0, behavior:'smooth'}); }
      });
    });
  </script>
</body>
</html>
