<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Portfolio – Kaitlin Calimbahin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Projects and experience" />
  <link rel="stylesheet" href="style.css" />
  <script src="data.js"></script>

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" sizes="any" href="/img/icons/favicon.svg?v=1">
  <link rel="icon" type="image/png" href="/img/icons/favicon-48.png">
  <meta name="theme-color" content="#FFC2D4">

  <!-- Per-page layout + media sizing/tuning -->
  <style>
    :root{
      --frame-basis: clamp(260px, 32vw, 460px);
      --media-scale: 1;
    }

    .project-row{
      display:flex;
      gap:18px;
      align-items:center;
      background:var(--surface);
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:18px;
      box-shadow:var(--shadow);
    }
    .project-row .project-text{ flex:1 1 auto; }
    .project-row .project-media{
      flex: 0 0 calc(var(--frame-basis) * var(--card-scale, var(--media-scale)));
    }

    .project-media .thumb{
      position: relative;
      overflow: hidden;
      border-radius: 12px;
      background: #222;
      aspect-ratio: 16 / 9;
      width: 100%;
    }
    .project-media .thumb img,
    .project-media .thumb video{
      position: absolute; inset: 0;
      width: 100%; height: 100%;
      object-fit: cover; display: block;
    }
    .project-media .thumb .poster{
      object-position: var(--poster-x, 50%) var(--poster-y, 50%);
      transform-origin: var(--poster-x, 50%) var(--poster-y, 50%);
      transform: scale(var(--poster-zoom, 1));
    }
    .project-media .thumb .clip{
      object-position: var(--video-x, 50%) var(--video-y, 50%);
      transform-origin: var(--video-x, 50%) var(--video-y, 50%);
      transform: scale(var(--video-zoom, 1));
      opacity: 0; transition: opacity .18s ease;
      pointer-events: none;
    }
    .project-row:hover .thumb .clip,
    .project-row:focus-within .thumb .clip{ opacity: 1; }

    .project-text p.project-subtitle{
      color: var(--text);
      font-weight: 600;
      font-size: clamp(1.05em, 1.4vw, 1.15em);
      line-height: 1.35;
      margin: 6px 0 10px;
    }

    @media (max-width: 900px){
      .project-row{ flex-direction: column; align-items: stretch; }
      .project-row .project-media{ flex: 0 0 auto; width: 100%; }
      :root{ --media-scale: 1; }
    }
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div><strong id="name"></strong><br /><span id="tagline"></span></div>
    </div>
    <nav>
      <a href="/#top" class="home-link">Home</a>
      <a href="portfolio.html">Portfolio</a>
      <a href="extracurriculars.html">Extracurriculars</a>
      <a href="/#contact">Contact</a>
      <button id="theme-toggle" class="icon-btn" type="button" aria-label="Toggle theme" title="Toggle theme"></button>
    </nav>
  </header>

  <main>
    <section>
      <h1>Portfolio</h1>
      <p class="about-in-hero">Here is a selection of my projects and work experience!</p>
    </section>

    <section id="projects" class="divided">
      <h2>Projects</h2>
      <div id="projects-list" class="stack-list"></div>
    </section>

    <section id="experience" class="divided">
      <h2>Experience</h2>
      <div id="experience-list" class="stack-list"></div>
    </section>
  </main>

  <footer>© <span id="year"></span> <span id="name-footer"></span></footer>

  <script>
    /* ---------- Header/footer text ---------- */
    const setText=(id,t)=>{const el=document.getElementById(id); if(el) el.textContent=t;}
    setText("name", siteData.name);
    setText("tagline", siteData.tagline);
    setText("name-footer", siteData.name);
    const y=document.getElementById("year"); if (y) y.textContent=new Date().getFullYear();

    /* ---------- Global media scale (desktop) ---------- */
    const GLOBAL_MEDIA = { percent: 85 };
    document.documentElement.style.setProperty('--media-scale', (GLOBAL_MEDIA.percent/100));

    /* ---------- Page-local content ---------- */
    const PORTFOLIO_PROJECTS = [
      { id:"pinball", title:"Star Wars: Pinball Machine",
        desc:"This fully functional pinball machine was designed and built with a Star Wars theme, featuring a laser-cut plywood and acrylic playfield with 3D-printed components such as flippers, bumpers, and themed features. An Arduino Mega controlled custom circuitry that powered lights, sounds, and mechanics, including a “hyperspace lever” automated launch system. Interactive elements like an AT-AT bumper, a spinning R2-D2, and a glowing Death Star created an immersive gameplay experience that blended engineering with storytelling.",
        poster:"/media/projects/pinball.png",
        video:"/media/projects/pinball.mp4",
        demo:"demo.html?id=pinball"
      },
      { id:"kitty-robot", title:"Face Recognition Study Buddy Robot",
        desc:"The Study Buddy Kitty was designed to help students stay focused by reacting to their behavior in playful, expressive ways. Using an ESP32 Camera module, supervised learning, and computer vision, the robot detects when a student was present or distracted by their phone, responding with emotions shown on its OLED screen and expressed by a servo-driven tail. A motion sensor allowed it to “feel” petting, turning the robot into a supportive study companion that encouraged productivity through interaction.",
        poster:"/media/projects/kitty-robot.png",
        video:"/media/projects/kitty-robot.mp4",
        demo:"demo.html?id=kitty-robot"
      },
      { id:"spider-mask", title:"Dynamic Spider-Man Mask",
        desc:"This project recreated Spider-Man’s expressive eyes through a 3D-printed mask with mechanical lenses that widened and squinted. Infrared sensors inside the mask detected user input and, via an Arduino Nano, smoothly adjusted the lenses in real time—capturing the character’s dynamic personality without external switches.",
        poster:"/media/projects/spider-mask.png",
        video:"/media/projects/spider-mask.mp4",
        demo:"demo.html?id=spider-mask"
      },
      { id:"ironman", title:"Motorized Iron Man Helmet",
        desc:"A 3D-printed Iron Man helmet with a motorized faceplate and LED eyes, built as an analog system (servos, relays, switches—no MCU). Through careful circuit design, the eyes run safely at maximum brightness while the faceplate moves smoothly and reliably.",
        poster:"/media/projects/ironman.png",
        video:"/media/projects/ironman1.mp4",
        demo:"demo.html?id=ironman"
      }
    ];

    const EXPERIENCE_ITEMS = [
      { id:"robotics-lead",
        title:"Advanced Robotics and Control Lab – Research Engineer Intern",
        subtitle:"Project: The N2D Haptic Glove",
        details:"The N2D Haptic Glove is a multi-finger glove capable of rendering 2D directional forces, allowing users to feel axial and transverse probing during teleoperation and virtual reality. Compact linkages, gimbal motors with encoders, and a Teensy 4.1 enable high-frequency control and realistic, precise feedback for contact-rich interaction.",
        poster:"/media/projects/haptic-glove2.png",
        video:"/media/projects/haptic-glove1.mp4",
        /* NEW: paper + demo id */
        paper:"/papers/N2D_Haptic_Glove.pdf",
        demoId:"haptic-glove"
      },
      { id:"ng-intern",
        title:"Northrop Grumman – Systems Engineer Intern",
        subtitle:"Project: Automated Hardware Validation Script",
        details:"I developed an automated checkout script for the BACN program that replaced manual hardware validation steps. Working with a multidisciplinary team, I streamlined testing, improved reliability, and laid the groundwork for faster field deployment.",
        poster:"/media/experience/ng1.png"
      }
    ];

    /* ---------- Per-card tuning ---------- */
    const TUNING = {
      /* Projects */
      "haptic-glove": { ratio:"16 / 12",
        percent: 95,
        poster:{ x:"50%", y:"50%", zoom:1.00 },
        video: { x:"52%", y:"48%", zoom:1.00 }
      },
      "kitty-robot":  { ratio:"16 / 19", percent: 80,
        poster:{ x:"1%", y:"40%", zoom:1.00 },
        video: { x:"1%", y:"40%", zoom:1.00 }
      },
      "ironman":      { ratio:"16 / 20", percent: 70,
        poster:{ x:"50%", y:"50%", zoom:1.00 },
        video: { x:"50%", y:"50%", zoom:1.00 }
      },
      "pinball":      { ratio:"6 / 9", percent: 75,
        poster:{ x:"50%", y:"20%", zoom:1.00 },
        video: { x:"50%", y:"20%", zoom:1.00 }
      },
      "spider-mask":  { ratio:"2 / 3", percent: 75,
        poster:{ x:"50%", y:"50%", zoom:1.00 },
        video: { x:"50%", y:"50%", zoom:1.00 }
      },

      /* Experience */
      "robotics-lead": {
        ratio:"8 / 6",
        poster:{ x:"70%", y:"50%", zoom:1.00 },
        video: { x:"50%", y:"50%", zoom:1.18 }
      },
      "ng-intern": { ratio:"19 / 10", percent:100,
        poster:{ x:"50%", y:"50%", zoom:1.00 }
      }
    };

    /* ---------- Helpers ---------- */
    function applyThumbTuning(thumb, tune){
      if (!thumb || !tune) return;
      if (tune.ratio) thumb.style.aspectRatio = tune.ratio;
      const p=tune.poster||{}, v=tune.video||{};
      if (p.x) thumb.style.setProperty('--poster-x', p.x);
      if (p.y) thumb.style.setProperty('--poster-y', p.y);
      if (p.zoom) thumb.style.setProperty('--poster-zoom', p.zoom);
      if (v.x) thumb.style.setProperty('--video-x', v.x);
      if (v.y) thumb.style.setProperty('--video-y', v.y);
      if (v.zoom) thumb.style.setProperty('--video-zoom', v.zoom);
    }
    function applySizeTuning(mediaEl, tune){
      if (!mediaEl || !tune) return;
      if (typeof tune.percent === 'number'){
        mediaEl.style.setProperty('--card-scale', (tune.percent/100));
      } else {
        mediaEl.style.removeProperty('--card-scale');
      }
      if (tune.width){
        mediaEl.style.setProperty('--frame-basis', tune.width);
      } else {
        mediaEl.style.removeProperty('--frame-basis');
      }
    }

    /* ---------- Row builders ---------- */
    function makeProjectRow(item){
      const row=document.createElement("article"); row.className="project-row"; row.id=item.id;

      const text=document.createElement("div"); text.className="project-text";
      const demoLink = item.demo ? `<p style="margin-top:10px"><a class="btn" href="${item.demo}">Watch Full Demo ↗</a></p>` : ``;
      text.innerHTML = `<h3>${item.title}</h3><p>${item.desc||""}</p>${demoLink}`;

      const media=document.createElement("div"); media.className="project-media";
      media.innerHTML = `
        <div class="thumb">
          <img class="poster" src="${item.poster}" alt="${item.title}">
          ${item.video ? `<video class="clip" muted playsinline loop preload="metadata"><source src="${item.video}" type="video/mp4"></video>` : ``}
        </div>`;

      row.appendChild(text); row.appendChild(media);

      const tune=TUNING[item.id]||{};
      applyThumbTuning(media.querySelector('.thumb'), tune);
      applySizeTuning(media, tune);

      const vid=media.querySelector('video.clip');
      if (vid){
        const play=()=>vid.play().catch(()=>{});
        const pause=()=>vid.pause();
        row.addEventListener('mouseenter', play);
        row.addEventListener('mouseleave', pause);
        row.addEventListener('focusin', play);
        row.addEventListener('focusout', pause);
        document.addEventListener('visibilitychange', ()=>{ if (document.hidden) vid.pause(); });
      }
      return row;
    }

    function makeExperienceRow(item){
      const row=document.createElement("article"); row.className="project-row"; row.id=item.id;

      const text=document.createElement("div"); text.className="project-text";
      let actionsHTML = "";
      if (item.id === "robotics-lead") {
        const paperHref = item.paper || "/papers/N2D_Haptic_Glove.pdf";
        const demoHref  = `demo.html?id=${encodeURIComponent(item.demoId || "haptic-glove")}`;
        actionsHTML = `
          <div class="row" style="margin-top:10px">
            <a class="btn" href="${demoHref}">Watch Demo Video</a>
            <a style="margin-left:8px" href="${paperHref}" target="_blank" rel="noopener">Research Paper (PDF) ↗</a>
          </div>`;
      }

      text.innerHTML = `
        <h3>${item.title}</h3>
        ${item.subtitle ? `<p class="project-subtitle">${item.subtitle}</p>` : ``}
        <p>${item.details || ""}</p>
        ${actionsHTML}
      `;

      const media=document.createElement("div"); media.className="project-media";
      media.innerHTML = `
        <div class="thumb">
          <img class="poster" src="${item.poster}" alt="${item.title}">
          ${item.video ? `<video class="clip" muted playsinline loop preload="metadata"><source src="${item.video}" type="video/mp4"></video>` : ``}
        </div>`;

      row.appendChild(text); row.appendChild(media);

      const tune=TUNING[item.id]||{};
      applyThumbTuning(media.querySelector('.thumb'), tune);
      applySizeTuning(media, tune);

      const vid=media.querySelector('video.clip');
      if (vid){
        const play=()=>vid.play().catch(()=>{});
        const pause=()=>vid.pause();
        row.addEventListener('mouseenter', play);
        row.addEventListener('mouseleave', pause);
        row.addEventListener('focusin', play);
        row.addEventListener('focusout', pause);
        document.addEventListener('visibilitychange', ()=>{ if (document.hidden) vid.pause(); });
      }

      return row;
    }

    /* ---------- Render ---------- */
    const projWrap=document.getElementById("projects-list");
    PORTFOLIO_PROJECTS.forEach(p => projWrap.appendChild(makeProjectRow(p)));

    const expWrap=document.getElementById("experience-list");
    EXPERIENCE_ITEMS.forEach(e => expWrap.appendChild(makeExperienceRow(e)));

    /* ---------- Theme toggle ---------- */
    const ICON_SUN = `
      <svg viewBox="0 0 24 24" fill="none"
           stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
        <circle cx="12" cy="12" r="4"></circle>
        <path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M4.93 19.07l1.41-1.41M17.66 6.34l1.41-1.41"/>
      </svg>`;
    const ICON_MOON = `
      <svg viewBox="0 0 24 24" fill="none"
           stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
      </svg>`;

    (function(){
      const root=document.documentElement;
      const btn=document.getElementById('theme-toggle');
      if (!btn) return;

      const prefersDark=()=>window.matchMedia('(prefers-color-scheme: dark)').matches;
      const getTheme=()=>localStorage.getItem('theme') || (prefersDark() ? 'dark' : 'light');

      function apply(theme){
        root.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
        const isDark = theme === 'dark';
        btn.innerHTML = isDark ? ICON_MOON : ICON_SUN;
        btn.setAttribute('aria-label', isDark ? 'Switch to light mode' : 'Switch to dark mode');
        btn.title = isDark ? 'Switch to light mode' : 'Switch to dark mode';
      }

      apply(getTheme());
      btn.addEventListener('click', ()=>apply(getTheme()==='dark'?'light':'dark'));
    })();

    /* Smooth scroll-to-top if on homepage already */
    document.querySelectorAll('a.home-link').forEach(a=>{
      a.addEventListener('click',(e)=>{
        const onHome = location.pathname === '/' || location.pathname.endsWith('/index.html') || location.pathname.endsWith('index.html');
        if (onHome){ e.preventDefault(); window.scrollTo({top:0, behavior:'smooth'}); }
      });
    });
  </script>
</body>
</html>
